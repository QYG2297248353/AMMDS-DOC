---
sidebar_position: 2
sidebar_label: "スクレイピングタスクの実行"
---

# スクレイピングタスクの実行

スクレイピングタスクはスクレイピングプロセスの2番目のステップであり、スクレイピングルールに基づいてスキャン結果ファイルをスクレイピングし、動画のメタデータを取得して最終的な動画ファイルを生成し、動画整理作業を完了します。

<!-- truncate -->

## 前提条件

スクレイピングタスクを実行する前に、以下の条件を満たしていることを確認してください：

### ネットワーク接続

ファイルの整理にはインターネットを介して動画のメタデータを取得する必要があるため、プロジェクトがインターネットに正常にアクセスできることを確認する必要があります。

### メタデータプラグイン

動画のメタデータを取得するための鍵となる関連メタデータプラグインが有効になっていて正しく設定されていることを確認してください：

+ [Metatube プラグイン](/docs/plugin/metadata/Metatube)
+ [ThePornDB プラグイン](/docs/plugin/metadata/ThePornDB)
+ [StashBox プラグイン](/docs/plugin/metadata/ThePornDB)
+ [FanzaDMM プラグイン](/docs/plugin/metadata/FanzaDmm)
+ [Madou プラグイン](/docs/plugin/metadata/Madou)

:::warning 重要な注意事項
関連するメタデータプラグインが有効になっていないと、動画のメタデータを取得できず、スクレイピングに失敗します。
:::

:::info データソースの声明
本ソフトウェアはいかなるソースデータも提供しません。すべての動画メタデータはユーザーが自ら設定したプラグインサービスから取得されます。
:::

## スクレイピングタスクの実行

### ステップ 1：スクレイピング入庫ページに入る

左側のナビゲーションバーから **タスク管理** に入り、**スクレイピング入庫** オプションを選択して、スクレイピング入庫ページに入ります。

![スクレイピング入庫ページ](/img/usage/scrape/task-scrape-01.png)

### ステップ 2：スクレイピングするファイルを選択する

スクレイピング入庫ページでは、スキャンタスクによって記録されたすべてのスクレイピング待ちファイルのリストを確認できます。必要に応じて、スクレイピングしたいファイルにチェックを入れます。

### ステップ 3：スクレイピングタスクの実行を開始する

ページの **スクレイピング整理** ボタンをクリックすると、システムがスクレイピングタスクの実行を開始します。

![スクレイピングタスクの実行](/img/usage/scrape/task-scrape-02.png)

### ステップ 4：タスク実行ステータスを確認する

タスクの実行中、ページにはスクレイピングタスクの実行状況がリアルタイムで表示されます。具体的には：
- スクレイピングに成功したファイル数
- スクレイピングに失敗したファイル数
- スキップされたファイル数

### ステップ 5：スクレイピングタスクの終了（必要に応じて）

実行中にスクレイピングタスクを終了する必要がある場合、いつでも **キャンセル** ボタンをクリックしてタスクの実行を停止することができます。

## スクレイピングの原理説明

スクレイピングタスクの動作原理は以下の通りです：

1. **スクレイピングルールの読み取り**：システムは設定されたスクレイピングルールに基づいて、異なるタイプのファイルをどのように処理するかを決定します
2. **メタデータのマッチング**：有効化されたメタデータプラグインを通じて、動画の詳細情報をマッチングして取得しようとします
3. **動画ファイルの生成**：取得したメタデータに基づいて、システムは標準化された動画ファイルを生成します
4. **ファイル構造の整理**：予め設定された命名規則とディレクトリ構造に従って、動画ファイルを整理します

## よくある問題と解決策

### 問題：スクレイピングに失敗する

**考えられる原因**：
- ネットワーク接続の問題
- メタデータプラグインが有効になっていないか、設定エラーがある
- スクレイピングルールの設定が適切でない
- ファイル命名がマッチングルールに合致しない

**解決策**：
- ネットワーク接続が正常であるかどうかを確認してください
- メタデータプラグインが有効になっていて正しく設定されていることを確認してください
- スクレイピングルールの設定が合理的であるかどうかを確認してください
- ファイル命名の形式を変更して、マッチングルールにより合致するようにしてみてください

### 問題：メタデータの取得が不完全

**考えられる原因**：
- プラグインサービスが一時的に利用不可
- 動画情報がプラグインサービスに存在しない
- ネットワーク遅延による取得タイムアウト

**解決策**：
- 後で再試行してください。プラグインサービスが一時的に利用不可の可能性があります
- 他のメタデータプラグインを使用してみてください
- ネットワーク接続の安定性を確認してください

## ベストプラクティス

1. **分割処理**：大量のファイルについては、システム負荷を過度に高めないように、分割してスクレイピングすることを推奨します
2. **優先設定**：スクレイピングを実行する前に、スクレイピングルールとメタデータプラグインが正しく設定されていることを確認してください
3. **定期更新**：より良いマッチング効果を得るために、メタデータプラグインを定期的に更新してください
4. **ログの確認**：スクレイピングに失敗した場合は、詳細なエラー情報を取得するためにシステムログを確認してください

## 注意事項

:::caution 注意
スクレイピングタスクは、ファイル数とネットワーク速度によって異なりますが、完了するまでに長時間かかる場合がありますので、お待ちください。
:::

:::tip ヒント
最適なスクレイピング効果を得るには、ファイル命名をできるだけ標準化し、必要な識別情報（番号、タイトルなど）を含めることを推奨します。
:::


