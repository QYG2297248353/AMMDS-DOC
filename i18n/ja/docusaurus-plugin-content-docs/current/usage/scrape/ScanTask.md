---
sidebar_position: 1
sidebar_label: "スキャンタスクの作成"
---

# スキャンタスクの作成

スキャンタスクはスクレイププロセスの最初のステップであり、スキャンルールに従ってターゲットディレクトリのファイルをスキャンし、スキャン結果ファイルを生成します。スキャンタスクを使用することで、選択的にファイルをスクレイプし、スクレイプ効率を向上させ、ゴミファイルのスクレイプを回避することができます。

<!-- truncate -->

## タスクリストへのアクセス

以下のパスからタスクリストページにアクセスすることができます：

**タスク管理 >> タスク設定 >> タスクリスト**

タスクリストページで、**タスクの作成**ボタンをクリックしてスキャンタスクを作成します。

## マルチタスク管理

ニーズに応じて、複数の異なるスキャンタスクを設定することができます。各タスクは異なるスキャンディレクトリと出力ディレクトリを持つことができます。

**マルチタスク管理の利点**：
- ビデオファイルの分類と管理に役立ちます
- 異なるタイプのビデオファイルに異なる処理ルールを設定することができます
- 全体的な処理効率が向上します

**例**：
- 日本産のビデオファイルを専門的にスキャンし、指定されたディレクトリに出力するスキャンタスクを作成します
- 欧米のビデオファイルを専門的にスキャンし、別のディレクトリに出力する別のスキャンタスクを作成します

## スキャンタスクの作成

![スキャンタスクの作成](/img/usage/scrape/task-scan-01.png)

### タスク名

**機能説明**：スキャンタスクの名前を設定します。

**設定推奨**：後続の管理と識別のために説明的な名前を使用してください。例：「日本産ビデオスキャン」、「欧米ビデオスキャン」など。

### メディアタイプ

**機能説明**：スキャンタスクのメディアタイプを設定します。

**作用**：システムの番号識別を補助し、番号識別率を向上させます。

**設定推奨**：混合タイプのビデオファイルの場合は、「すべて」を選択してください。

### 整理モード

**機能説明**：ファイルの整理方法を設定します。

**オプションモード**：

#### 原地整理
- **機能**：整理時に親ディレクトリに対して操作を行わず、元のファイルが存在するディレクトリ内で直接整理します
- **適用シナリオ**：ファイルの位置を変更せず、ファイルの名前変更またはメタデータ整理のみを希望する場合

#### 移動モード
- **機能**：整理時にファイルをターゲットディレクトリに移動します
- **ターゲットディレクトリ**：スクレイプ設定で設定された形式
- **適用シナリオ**：ファイルを指定されたディレクトリに集中管理したい場合

#### コピーモード
- **機能**：整理時にファイルをターゲットディレクトリにコピーします
- **ターゲットディレクトリ**：スクレイプ設定で設定された形式
- **適用シナリオ**：元のファイルを保持しながら、指定されたディレクトリに整理済みのコピーを作成したい場合

#### ソフトリンクモード
- **機能**：整理時にファイルのソフトリンクをターゲットディレクトリに作成します
- **ターゲットディレクトリ**：スクレイプ設定で設定された形式
- **特徴**：
  - 追加のディスク領域を占有しません
  - ソフトリンクファイルは元のファイルへのポインタです
  - 元のファイルが削除または移動された場合、ソフトリンクファイルは無効になります
- **適用シナリオ**：追加の領域を占有せずに、指定されたディレクトリにファイルアクセスエントリを作成したい場合

#### ハードリンクモード
- **機能**：整理時にファイルのハードリンクをターゲットディレクトリに作成します
- **ターゲットディレクトリ**：スクレイプ設定で設定された形式
- **特徴**：
  - 追加のディスク領域を占有します
  - ハードリンクファイルは元のファイルへのポインタです
  - 元のファイルが削除または移動された場合でも、ハードリンクファイルは有効なままです
  - ハードリンクファイルは同じファイルシステム内でのみ作成できます
- **適用シナリオ**：同じファイルシステム内にファイルの複数の参照を作成し、ファイルの安全性を確保したい場合
- **注意**：条件が非常に厳しいため、一般的に推奨されません

:::info ヒント
原地整理モードを除く他の整理モードでは、ターゲットディレクトリを指定する必要があります。
:::

### スキャンディレクトリ

**機能説明**：スキャンタスクのターゲットディレクトリを設定します。

**作用**：システムはこのディレクトリ内のすべてのファイルを再帰的にスキャンします。

**設定推奨**：処理するビデオファイルを含むディレクトリを選択してください。

### 整理ディレクトリ

**機能説明**：ファイル整理のターゲットディレクトリを設定します。

**適用シナリオ**：原地整理モードを除く他の整理モードでは、このディレクトリを指定する必要があります。

**設定推奨**：整理後のファイルを保存するために十分なストレージスペースを持つディレクトリを選択してください。

### 名前変更ルール

**機能説明**：ファイルの名前変更方法を設定します。

**オプションルール**：

#### 元のファイル名
- **機能**：整理時に元のファイル名を変更しません
- **適用シナリオ**：ファイルの元の命名を保持したい場合

#### 標準化されたファイル名
- **機能**：整理時に、スクレイプ設定で設定されたファイル名形式に従ってファイル名を標準化します
- **命名の基礎**：スクレイプ設定で設定されたファイル名形式に依存します
- **適用シナリオ**：ファイル命名形式を統一し、ファイル管理の標準化を向上させたい場合

### 重複ファイルの処理

**機能説明**：ターゲットファイルが既に存在する場合の処理方法を設定します。

**設定推奨**：スキップ、上書き、名前変更など、ニーズに応じて適切な処理方法を選択してください。

### ディレクトリ監視

**機能説明**：有効にすると、スキャンタスクの初期初期化後、システムはこのディレクトリを監視し、新しいファイルが出現したときに自動的にスキャンしてスキャン結果ファイルに追加します。

**適用シナリオ**：手動でスキャンをトリガーすることなく、システムに新しく追加されたファイルを自動的に処理させたい場合

### お気に入りに追加

**機能説明**：有効にすると、整理後にこのビデオのメタデータが自動的にお気に入りに追加されます。

**適用シナリオ**：重要なビデオリソースをすばやくマークしてアクセスしたい場合

### スケジュールタスク

**機能説明**：スキャンタスクの自動実行時間を設定します。

**注意**：これはディレクトリ監視と競合します。いずれか一方のみを選択できます。

**設定形式**：Springスタイルのcron式を使用します

**例**：毎時間スキャンタスクを実行するには、`0 0 * * * ?` と入力します

## スキャンタスクの実行

作成後、**すぐにスキャン**ボタンをクリックしてスキャンタスクを実行します。

![スキャンタスクの実行](/img/usage/scrape/task-scan-02.png)

### タスク管理操作

- **編集**：**編集**ボタンをクリックして、スキャンタスクの設定を変更します
- **記録**：**記録**ボタンをクリックして、スキャンタスクの実行履歴記録を表示します
- **削除**：**削除**ボタンをクリックして、不要なスキャンタスクを削除します

### スキャン結果の表示

![スキャン結果の表示](/img/usage/scrape/task-scan-03.png)

スキャンが完了した後、新しく追加されたスクレイプ可能なファイルは**タスク管理 >> スクレイプとストレージ**で表示および処理することができます。

## スケジュールタスク

プロジェクトは、スケジュールタスクの実行時間を指定するためにSpringスタイルのcron式を使用します。

### 一般的な式

| 式 | 説明 |
|-----|-------|
| `0 0 * * * ?` | 毎時間実行 |
| `0 0 0 * * ?` | 毎日深夜に実行 |
| `0 0 0 * * 1` | 毎週月曜日の深夜に実行 |
| `0 0 0 1 * ?` | 毎月1日の深夜に実行 |

## 設定例

以下は、典型的なスキャンタスクの設定例です：

| 設定項目 | 設定値 |
|---------|--------|
| タスク名 | 日本産ビデオスキャン |
| メディアタイプ | 日本産 |
| 整理モード | 移動モード |
| スキャンディレクトリ | `D:\Downloads\NewMovies` |
| 整理ディレクトリ | `E:\Media\Movies\Japanese` |
| 名前変更ルール | 標準化されたファイル名 |
| 重複ファイルの処理 | スキップ |
| ディレクトリ監視 | 有効 |
| お気に入りに追加 | 無効 |
| スケジュールタスク | - |

## よくある質問

### Q: スキャンタスクの実行に失敗した場合はどうすればよいですか？

**A**：考えられる理由は以下の通りです：
- スキャンディレクトリが存在しないか、アクセス権限がありません
- 整理ディレクトリが存在しないか、書き込み権限がありません
- 設定エラー
- システムリソース不足

**解決策**：
- ディレクトリパスと権限を確認してください
- 設定パラメータを確認してください
- システムに十分なリソースがあることを確認してください
- 具体的なエラー情報を理解するために実行記録を表示してください

### Q: ディレクトリ監視とスケジュールタスクの違いは何ですか？

**A**：
- **ディレクトリ監視**：ディレクトリの変更をリアルタイムで監視し、新しいファイルが追加されたときに即座に処理します
- **スケジュールタスク**：事前設定された時間間隔で定期的にスキャンを実行します

### Q: ソフトリンクとハードリンクの違いは何ですか？

**A**：
- **ソフトリンク**：Windowsのショートカットに相当し、追加の領域を占有せず、元のファイルに依存します
- **ハードリンク**：ファイルの複数の参照に相当し、追加の領域を占有しますが、元のファイルに依存しません（元のファイルが削除された後も使用可能）

### Q: スキャン結果に一部のファイルが表示されないのはなぜですか？

**A**：考えられる理由は以下の通りです：
- ファイル形式がスキャンルールの形式制限リストに含まれていません
- ファイルのディレクトリが無視ディレクトリに追加されています
- ファイル名に無視される文字列が含まれています
- ファイルサイズが設定された最小ビデオサイズのしきい値より小さい

### Q: スキャン効率を向上させるにはどうすればよいですか？

**A**：以下の方法を試すことができます：
- 無視ディレクトリと無視ファイルを合理的に設定します
- 異なるタイプのファイルに専門的なスキャンタスクを作成します
- 繰り返しのスキャンを避けるためにディレクトリ監視機能を使用します
- システムリソースの割り当てを適切に調整します

## ベストプラクティス

- **タスク分類**：ビデオタイプに応じて異なるスキャンタスクを作成し、処理効率を向上させます
- **合理的な命名**：後続の管理のために説明的なタスク名を使用します
- **定期的なメンテナンス**：不要なスキャンタスクを定期的に確認およびクリーンアップします
- **設定のバックアップ**：重要な設定を変更する前に、現在の設定を記録しておき、問題が発生した場合に復元できるようにします
- **実行の監視**：スキャンタスクの実行記録を定期的に表示し、問題をタイムリーに発見して解決します
