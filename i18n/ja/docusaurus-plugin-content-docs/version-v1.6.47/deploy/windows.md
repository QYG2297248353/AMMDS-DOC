---
sidebar_position: 4
sidebar_label: "Windows"
---

# Windowsデプロイガイド

Microsoft Windows（略してWindows）は、マイクロソフト社が開発した一連の専有商用オペレーティングシステムであり、グラフィカルユーザーインターフェースを中核機能とし、パーソナルコンピュータ、サーバーなどのデバイスに広く適用されています。このガイドでは、Windows環境でのAMMDSのデプロイ手順について詳しく説明します。

<!-- truncate -->

## ダウンロード

![AMMDS Launcher下载页面](/img/deploy/install-windows-00.png)

### 公式リリースアドレス

[AMMDS Launcher GitHub Releases](https://github.com/QYG2297248353/AMMDS-Launcher/releases)

### 利用可能なインストールパッケージの種類

| ファイル名            | タイプ     | 説明                                                                 |
| ----------------- | -------- | -------------------------------------------------------------------- |
| `ammds-setup.exe` | インストーラー | 完全なAMMDS Launcherインストールパッケージ，自動インストールウィザードとすべての必要なコンポーネントを含む           |
| `ammds.zip`       | ポータブル版   | インストール不要のグリーンバージョン，解凍後すぐに実行可能，一時的な使用や管理者権限のない環境に適している |

### 推奨ダウンロード

**推奨ダウンロード：** `ammds-setup.exe`

インストーラーを使用すると、すべての依存コンポーネントが正しくインストールされ、より良いシステム統合エクスペリエンスが得られます。

## インストール

### 前提条件

- オペレーティングシステム：Windows 10 またはそれ以降のバージョン
- 権限：インストールには管理者権限が必要
- ネットワーク：初回起動時に必要なリソースをダウンロードするためにネットワーク接続が必要

### インストール手順

1. **インストーラーを起動**

   ダウンロードした`ammds-setup.exe`ファイルをダブルクリックし、インストールウィザードを起動します。

2. **インストール言語を選択**

   ![安装语言选择界面](/img/deploy/install-windows-01.png)

   言語選択画面で、**简体中文**をインストール言語として選択し、「OK」をクリックします。

3. **追加コンポーネントを選択**

   ![附加组件选择界面](/img/deploy/install-windows-02.png)

   コンポーネント選択画面で、システムによってすべての利用可能な追加コンポーネントが一覧表示されます。完全な機能を得るには、**すべてのコンポーネントにチェックを入れる**ことを推奨します：
   - コアコンポーネント：AMMDS Launcherメインプログラム
   - 依存ライブラリ：必要な実行時環境
   - システム統合：トレイアイコンと自動起動機能

4. **インストールを開始**

   ![安装确认界面](/img/deploy/install-windows-03.png)

   インストール設定を確認した後、「インストール」ボタンをクリックしてインストールプロセスを開始します。

5. **インストールの進行状況**

   ![安装进度界面](/img/deploy/install-windows-04.png)

   インストーラーによって現在のインストールの進行状況と状態が表示されます。インストールが完了するまでお待ちください。

6. **インストールの完了**

   ![安装完成界面](/img/deploy/install-windows-05.png)

   インストールが完了したら、「完了」ボタンをクリックしてインストールウィザードを終了します。

### 初回起動

インストールが完了すると、システムによってAMMDS Launcherが自動的に起動され、公式ドキュメントのホームページが表示されます。

![首次启动白屏状态](/img/deploy/install-windows-06.png)

**注意：** 初回起動時に白い画面が表示されることがありますが、これは正常な初期化プロセスです。バックグラウンドで必要なリソースファイルをダウンロードしていますので、しばらくお待ちください。ダウンロードが完了すると、ページが自動的に更新されます。

![AMMDS Launcher主界面](/img/deploy/install-windows-07.png)

リソースのダウンロードが完了すると、システムによってAMMDS Launcherのメインインターフェースに自動的に移行し、これですべての機能を使用し始めることができます。

### インストールの注意事項

- インストール中にインストールウィンドウを閉じないでください
- 初回起動時はネットワーク接続が正常であることを確認してください
- インストールに失敗した場合は、十分なディスク容量と管理者権限があるか確認してください

## アップグレード

### アップグレード前の準備

- **データのバックアップ**：アップグレード前にAMMDSの設定ファイルと重要なデータをバックアップすることを推奨します
- **プログラムの終了**：AMMDS Launcherが完全に終了していることを確認してください（トレイアイコンも含む）
- **新バージョンのダウンロード**：公式GitHub Releasesページから最新バージョンの`ammds-setup.exe`をダウンロードしてください

### アップグレード手順

1. **アップグレードプログラムを起動**

   ダウンロードした新バージョンの`ammds-setup.exe`ファイルをダブルクリックし、アップグレードウィザードを起動します。

2. **アップグレードウィザードに従う**

   アップグレードウィザードによって既にインストールされているバージョンが自動的に検出され、上書きアップグレードを提案されます。ウィザードの指示に従ってアップグレードプロセスを完了してください。

3. **アップグレードの完了**

   アップグレードが完了したら、「完了」ボタンをクリックしてウィザードを終了します。システムによって新バージョンのAMMDS Launcherが自動的に起動されます。

### アップグレードメカニズムの説明

AMMDS Launcherは**上書きアップグレード**メカニズムを採用しています。具体的な特徴は以下のとおりです：

- ユーザー設定とデータの保持：アップグレードプロセスによって既存の設定ファイルとデータディレクトリが保持されます
- コアコンポーネントの更新：古いバージョンの実行ファイルと依存ライブラリが自動的に置き換えられます
- システム統合の保持：トレイアイコン、自動起動などのシステム統合設定が保持されます

### アップグレード後の検証

アップグレードが完了した後、以下の検証を行うことを推奨します：

1. AMMDS Launcherが正常に起動するか確認する
2. バージョン番号が更新されているか確認する（[について]ページで確認可能）
3. すべての機能が正常に動作するか確認する
4. データと設定が完全に保持されているか確認する

### アップグレードの注意事項

- アップグレード中にアップグレードウィンドウを閉じないでください
- アップグレードに失敗した場合は、古いバージョンをアンインストールしてから新しいバージョンをインストールしてみてください
- メジャーバージョンのアップグレードでは、一部のリソースファイルを再ダウンロードする必要がある場合があります

## システムトレイ管理

![AMMDS Launcher托盘菜单](/img/deploy/install-windows-08.png)

### トレイ機能の概要

AMMDS Launcherのインストールが完了すると、Windowsシステムトレイに専用のアイコンが作成され、クイックアクセスと管理機能が提供されます。トレイアイコンを右クリックすると、機能メニューが開き、様々な操作を実行することができます。

### トレイメニュー機能

| メニュー項目           | 機能説明                   | 技術説明                                                  |
| ---------------- | -------------------------- | --------------------------------------------------------- |
| **データディレクトリを開く** | AMMDSのリソース保存ディレクトリを開く    | `%APPDATA%\AMMDS`ディレクトリに直接アクセスし、データ、設定、ログファイルを含む |
| **起動**         | AMMDS Launcherサービスを起動     | バックグラウンドサービスプロセスを起動し、接続を待ち受ける                            |
| **再起動**         | AMMDS Launcherを再起動         | 既存のプロセスを停止してから再び起動し、設定の変更を適用する              |
| **停止**         | AMMDS Launcherサービスを停止     | バックグラウンドサービスプロセスを停止し、システムリソースを解放                            |
| **終了**         | AMMDS Launcherを完全に終了     | サービスを停止してトレイアイコンを削除し、すべてのリソースを完全に解放                  |
| **パネルを開く**     | AMMDS Launcherメインインターフェースを開く   | Web管理インターフェースを起動して表示し、AMMDSの設定と管理に使用                |
| **自動起動を開始** | システム起動時の自動起動機能を切り替え | Windows起動項目にAMMDS Launcherを追加または削除                 |

### トレイアイコンの状態説明

- **カラーアイコン**：AMMDS Launcherサービスが実行中
- **グレーアイコン**：AMMDS Launcherサービスが停止している
- **点滅アイコン**：AMMDS Launcherが起動中または再起動中

### 使用上の推奨事項

- **日常管理**：トレイメニューを使用して、起動、停止、再起動の操作を迅速に行う
- **トラブルシューティング**：問題が発生した場合は、再起動機能を使用して解決を試みる
- **システム最適化**：長期間AMMDSを使用しない場合は、終了機能を使用してリソースを完全に解放する
- **自動起動**：継続的に実行する必要があるシナリオでは、自動起動機能を有効にすることを推奨する

## 実行ログとデータ管理

### データディレクトリ構造

![AMMDS数据目录结构](/img/deploy/install-windows-09.png)

AMMDSのすべてのデータと設定ファイルは専用のデータディレクトリに保存されています。デフォルトのパスは：`%APPDATA%\AMMDS`です。

**ディレクトリ構造の説明：**

| ディレクトリ   | 機能説明              | 技術的詳細                                                   |
| ------ | --------------------- | ---------------------------------------------------------- |
| `data` | AMMDSリソースファイルを保存 | モデルファイル、設定テンプレート、プリセットなどのコアリソースを含み、初回起動時に自動的にダウンロードされる |
| `db`   | AMMDSデータベースファイルを保存 | ユーザー設定、実行履歴、タスクレコードなどの構造化データを含む               |
| `logs` | AMMDS実行ログファイルを保存 | システムログ、エラー記録、リソースダウンロードログなどを含む                     |

### ログファイルの説明

![AMMDS资源下载日志](/img/deploy/install-windows-10.png)

#### ログファイルの保存構造

AMMDSのログファイルは主に2つの場所に保存されています：

**1. AMMDSコアログ（data/logsディレクトリ）**
| ログファイル | 機能説明 |
|---------|----------|
| `data/logs/ammds.log` | システム実行ログ、AMMDSの起動、停止、エラーなどのシステムイベントを記録 |
| `data/logs/ammds-202x-xx-xx.log` | 日付で命名された実行ログ、AMMDSの詳細な実行状態と操作記録を記録 |
| `data/logs/ammds-error.log` | エラーログ、システム実行中のエラー情報を専門的に記録 |

**2. Windowsランチャーログ（logsディレクトリ）**
| ログファイル | 機能説明 |
|---------|----------|
| `logs/launcher.log` | ランチャーログ、Windows AMMDS Launcherの起動プロセス、設定情報、システム統合状態を記録 |

### ログ内容の解釈

#### AMMDSコアログの内容

**1. システム実行ログ (`data/logs/ammds.log`)**

- AMMDSの起動と停止イベントを記録
- システムレベルのエラーと警告情報
- 設定の読み込みと初期化状態
- サービスの起動と停止状態

**2. 実行詳細ログ (`data/logs/ammds-202x-xx-xx.log`)**

- 詳細な操作記録と状態変化
- ユーザー操作とシステム応答
- リソース使用状況とパフォーマンス指標
- 定期タスクの実行状況

**3. エラーログ (`data/logs/ammds-error.log`)**

- 詳細なエラースタック情報
- 異常発生のコンテキスト
- エラー発生の時間と条件
- 可能性のあるエラー原因分析

#### Windowsランチャーログの内容

**ランチャーログ (`logs/launcher.log`)**

- ランチャーの起動プロセスと設定の読み込み
- システム統合状態（トレイアイコン、自動起動）
- AMMDSコアとの通信状態
- ランチャー自身のエラーと警告

#### リソースダウンロードログ

**リソースダウンロードログ**（関連するログファイルに含まれる）：

- リソースファイル名とバージョン情報
- ダウンロードの進行状況と速度統計
- ダウンロード状態（成功/失敗/再試行）
- ダウンロードのタイムスタンプと所要時間
- ダウンロードサーバー情報

:::info 進行状況の指示
ログに進行状況が100%に達したことが表示された場合、必要なすべてのリソースファイルのダウンロードが完了したことを意味します
:::

### ログの使用方法

#### 1. トラブルシューティング

**AMMDSコアの問題**

- 詳細なエラー情報を取得するには、`data/logs/ammds-error.log`を確認する
- システムの起動と初期化状態を了解するには、`data/logs/ammds.log`を参照する
- エラー発生前後の操作記録を確認するには、`data/logs/ammds-202x-xx-xx.log`を分析する

**ランチャーの問題**

- ランチャーの起動プロセスと設定状態を了解するには、`logs/launcher.log`を確認する
- AMMDSコアとの通信状態を確認する

#### 2. リソース管理

**リソースダウンロードの問題**

- ダウンロードに失敗したリソースを特定するには、ログのダウンロード記録を分析する
- ダウンロードサーバーの接続状態を確認する
- リソースファイルのバージョンと整合性を確認する

**ディスク領域管理**

- ログファイルのサイズを監視し、古いログを定期的にクリーンアップする
- リソースファイルのダウンロード量を分析し、ディスク領域を合理的に計画する

#### 3. パフォーマンス分析

**システムパフォーマンス**

- 各操作の実行時間を了解するには、ログのタイムスタンプを分析する
- リソース使用状況を監視し、システム設定を最適化する
- パフォーマンスのボトルネックを特定し、システムパラメータを調整する

**起動時間の最適化**

- ランチャーの起動プロセスの所要時間を分析するには、`logs/launcher.log`を分析する
- 初期化時間を確認するには、`data/logs/ammds.log`を確認する
- 起動項目と設定を最適化し、起動時間を短縮する

#### 4. ログファイル管理

**ログローテーション**

- AMMDSによってログのローテーションが自動的に行われ、日付で命名されたログファイルが生成される
- 古いログは圧縮またはクリーンアップされ、合理的なディスク使用量が維持される

**ログのバックアップ**

- 重要なログファイル、特にエラーログを定期的にバックアップする
- システムアップグレード前に現在のログをバックアップし、問題の比較分析に使用する

**ログレベルの調整**

- 必要に応じてログレベルを調整し、詳細さとパフォーマンスへの影響のバランスをとる
- 問題のデバッグ時には詳細なログを使用し、通常の実行時には標準ログを使用する

### 初回起動の注意事項

:::warning 初回起動のヒント
AMMDSを初回起動すると、システムによって以下の操作が実行されますので、しばらくお待ちください：

- **リソースのダウンロード**：必要なリソースファイル、モデルファイル、依存ライブラリなどを自動的にダウンロードする
- **時間の見積もり**：ネットワーク速度によって異なりますが、初回起動には5-30分程度かかる場合があります
- **ネットワークの要求**：ダウンロード中にネットワーク接続が安定していることを確認し、ネットワークを切断しないでください
- **ディスク領域**：ダウンロードしたリソースファイルを保存するための十分なディスク領域が必要です。少なくとも10GBの空き領域を確保することを推奨します
  :::

## 警告と注意事項

### セキュリティ警告

:::danger 重要なセキュリティのヒント

- **公式ソース**：AMMDSインストールパッケージは公式GitHub Releasesページからのみダウンロードし、サードパーティのダウンロードソースの使用は避けてください
- **ウイルス対策ソフトウェア**：インストール中にウイルス対策ソフトウェアの警告が表示された場合は、誤検知であることを確認した後、信頼済みに追加してください
- **管理者権限**：インストールとアップグレードのプロセスには管理者権限が必要です。インストーラーを管理者として実行することを確認してください
  :::

### システム要件

:::info システム構成要件

#### 最小要件

- オペレーティングシステム：Windows 10 64ビット
- プロセッサ：Intel Core i3または同等のパフォーマンス
- メモリ：4GB RAM
- ディスク領域：少なくとも10GBの空き領域
- ネットワーク：ブロードバンドインターネット接続

#### 推奨要件

- オペレーティングシステム：Windows 10/11 64ビット
- プロセッサ：Intel Core i5または同等のパフォーマンス
- メモリ：8GB RAMまたはそれ以上
- ディスク領域：20GBの空き領域
- ネットワーク：安定したブロードバンドインターネット接続

:::

### 使用上の注意事項

- **データバックアップ**：定期的にAMMDSのデータディレクトリをバックアップし、特に重要な設定ファイルとモデルファイルをバックアップする
- **リソース管理**：ディスク領域の使用状況を監視し、不要なリソースファイルを及时にクリーンアップする
- **ネットワーク接続**：特にリソースのダウンロードと更新時に、安定したネットワーク接続を確保する
- **システムメンテナンス**：システムの安定性を確保するために、定期的にWindowsシステムと関連ドライバーを更新する

### トラブルシューティング

#### よくある問題

- **インストール失敗**：管理者権限とディスク領域を確認する
- **起動時の白い画面**：リソースのダウンロードが完了するのを待つか、ネットワーク接続を確認する
- **機能の異常**：ログファイルを確認して問題を特定するか、AMMDS Launcherを再起動する
- **アップグレード失敗**：古いバージョンをアンインストールしてから新しいバージョンをインストールしてみる

#### 連絡先

解決できない問題が発生した場合は、公式GitHubリポジトリにアクセスしてIssueを提出するか、助けを求めてください

### ベストプラクティス

- **定期的な更新**：最新の機能とセキュリティ修正を取得するために、AMMDS Launcherを最新バージョンに保持する
- **合理的な設定**：システムパフォーマンスに応じてAMMDSのパラメータを合理的に設定し、リソースの過剰使用を避ける
- **安全な使用**：公式ドキュメントのガイダンスに従い、コア設定ファイルの変更を避ける
- **コミュニティへの参加**：AMMDSコミュニティに参加し、使用経験を共有し、問題をフィードバックする