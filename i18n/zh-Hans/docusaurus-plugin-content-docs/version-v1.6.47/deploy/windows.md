---
sidebar_position: 4
sidebar_label: "Windows"
---

# Windows部署指南

Microsoft Windows（简称Windows）是微软公司开发的一系列专有商业操作系统，以图形用户界面为核心特性，广泛应用于个人电脑、服务器等设备。本指南将详细介绍AMMDS在Windows环境下的部署流程。

<!-- truncate -->

## 下载

![AMMDS Launcher下载页面](/img/deploy/install-windows-00.png)

### 官方发行地址

[AMMDS Launcher GitHub Releases](https://github.com/QYG2297248353/AMMDS-Launcher/releases)

### 可用安装包类型

| 文件名            | 类型     | 说明                                                                 |
| ----------------- | -------- | -------------------------------------------------------------------- |
| `ammds-setup.exe` | 安装程序 | 完整的AMMDS Launcher安装包，包含自动安装向导和所有必要组件           |
| `ammds.zip`       | 便携版   | 绿色免安装版本，解压后即可直接运行，适合临时使用或无管理员权限的环境 |

### 推荐下载

**推荐下载：** `ammds-setup.exe`

使用安装程序可以确保所有依赖组件正确安装，并获得更好的系统集成体验。

## 安装

### 前置条件

- 操作系统：Windows 10 或更高版本
- 权限：需要管理员权限进行安装
- 网络：首次启动需要联网下载必要资源

### 安装步骤

1. **启动安装程序**

   双击下载的`ammds-setup.exe`文件，启动安装向导。

2. **选择安装语言**

   ![安装语言选择界面](/img/deploy/install-windows-01.png)

   在语言选择界面中，选择**简体中文**作为安装语言，然后点击“确定”。

3. **选择附加组件**

   ![附加组件选择界面](/img/deploy/install-windows-02.png)

   在组件选择界面中，系统会列出所有可用的附加组件。建议**勾选所有组件**以获得完整功能：
   - 核心组件：AMMDS Launcher主程序
   - 依赖库：必要的运行时环境
   - 系统集成：托盘图标和自动启动功能

4. **开始安装**

   ![安装确认界面](/img/deploy/install-windows-03.png)

   确认安装配置后，点击“安装”按钮开始安装过程。

5. **安装进度**

   ![安装进度界面](/img/deploy/install-windows-04.png)

   安装程序会显示当前安装进度和状态，请耐心等待安装完成。

6. **完成安装**

   ![安装完成界面](/img/deploy/install-windows-05.png)

   安装完成后，点击“完成”按钮退出安装向导。

### 首次启动

安装完成后，系统会自动启动AMMDS Launcher，并显示官方文档首页。

![首次启动白屏状态](/img/deploy/install-windows-06.png)

**注意：** 如果首次启动时出现白屏现象，这是正常的初始化过程。后台正在下载必要的资源文件，请耐心等待，下载完成后页面会自动刷新。

![AMMDS Launcher主界面](/img/deploy/install-windows-07.png)

资源下载完成后，系统将自动进入AMMDS Launcher主界面，此时您可以开始使用所有功能。

### 安装注意事项

- 安装过程中请勿关闭安装窗口
- 首次启动时请确保网络连接正常
- 如遇到安装失败，请检查是否有足够的磁盘空间和管理员权限

## 升级

### 升级前准备

- **备份数据**：升级前建议备份AMMDS的配置文件和重要数据
- **关闭程序**：确保AMMDS Launcher已完全关闭，包括托盘图标
- **下载新版本**：从官方GitHub Releases页面下载最新版本的`ammds-setup.exe`

### 升级步骤

1. **启动升级程序**

   双击下载的新版`ammds-setup.exe`文件，启动升级向导。

2. **跟随升级向导**

   升级向导会自动检测已安装的版本，并提示进行覆盖升级。按照向导提示完成升级过程。

3. **完成升级**

   升级完成后，点击“完成”按钮退出向导，系统会自动启动新版AMMDS Launcher。

### 升级机制说明

AMMDS Launcher采用**覆盖式升级**机制，具体特点如下：

- 保留用户配置和数据：升级过程会保留现有的配置文件和数据目录
- 更新核心组件：自动替换旧版本的可执行文件和依赖库
- 保持系统集成：托盘图标、自动启动等系统集成设置会被保留

### 升级后验证

升级完成后，建议进行以下验证：

1. 检查AMMDS Launcher是否正常启动
2. 验证版本号是否已更新（可在关于页面查看）
3. 确认所有功能是否正常工作
4. 检查数据和配置是否完整保留

### 升级注意事项

- 升级过程中请勿关闭升级窗口
- 如遇到升级失败，可尝试先卸载旧版本再安装新版本
- 重大版本升级可能需要重新下载部分资源文件

## 系统托盘管理

![AMMDS Launcher托盘菜单](/img/deploy/install-windows-08.png)

### 托盘功能概述

AMMDS Launcher安装完成后，会在Windows系统托盘中创建一个专用图标，提供快速访问和管理功能。通过右键点击托盘图标，可以打开功能菜单，执行各种操作。

### 托盘菜单功能

| 菜单项           | 功能说明                   | 技术说明                                                  |
| ---------------- | -------------------------- | --------------------------------------------------------- |
| **打开数据目录** | 打开AMMDS的资源存放目录    | 直接定位到`%APPDATA%\AMMDS`目录，包含数据、配置和日志文件 |
| **启动**         | 启动AMMDS Launcher服务     | 启动后台服务进程，准备接收连接                            |
| **重启**         | 重启AMMDS Launcher         | 先停止现有进程，再重新启动，用于应用配置更改              |
| **停止**         | 停止AMMDS Launcher服务     | 停止后台服务进程，释放系统资源                            |
| **退出**         | 完全退出AMMDS Launcher     | 停止服务并移除托盘图标，完全释放所有资源                  |
| **打开面板**     | 打开AMMDS Launcher主界面   | 启动并显示Web管理界面，用于配置和管理AMMDS                |
| **启动自动启动** | 切换系统启动时自动启动功能 | 在Windows启动项中添加或移除AMMDS Launcher                 |

### 托盘图标状态说明

- **彩色图标**：AMMDS Launcher服务正在运行
- **灰色图标**：AMMDS Launcher服务已停止
- **闪烁图标**：AMMDS Launcher正在启动或重启过程中

### 使用建议

- **日常管理**：使用托盘菜单进行快速的启动、停止和重启操作
- **故障排查**：当遇到问题时，可通过重启功能尝试解决
- **系统优化**：若长时间不使用AMMDS，建议使用退出功能完全释放资源
- **自动启动**：对于需要持续运行的场景，建议启用自动启动功能

## 运行日志与数据管理

### 数据目录结构

![AMMDS数据目录结构](/img/deploy/install-windows-09.png)

AMMDS的所有数据和配置文件存储在专用的数据目录中，默认路径为：`%APPDATA%\AMMDS`

**目录结构说明：**

| 目录   | 功能说明              | 技术细节                                                   |
| ------ | --------------------- | ---------------------------------------------------------- |
| `data` | 存储AMMDS资源文件     | 包含模型文件、配置模板、预设等核心资源，首次启动会自动下载 |
| `db`   | 存储AMMDS数据库文件   | 包含用户配置、运行历史、任务记录等结构化数据               |
| `logs` | 存储AMMDS运行日志文件 | 包含系统日志、错误记录、资源下载日志等                     |

### 日志文件说明

![AMMDS资源下载日志](/img/deploy/install-windows-10.png)

#### 日志文件存储结构

AMMDS的日志文件主要存储在两个位置：

**1. AMMDS核心日志（data/logs目录）**
| 日志文件 | 功能说明 |
|---------|----------|
| `data/logs/ammds.log` | 系统运行日志，记录AMMDS的启动、停止、错误等系统事件 |
| `data/logs/ammds-202x-xx-xx.log` | 日期命名的运行日志，记录AMMDS的详细运行状态和操作记录 |
| `data/logs/ammds-error.log` | 错误日志，专门记录系统运行过程中的错误信息 |

**2. Windows启动器日志（logs目录）**
| 日志文件 | 功能说明 |
|---------|----------|
| `logs/launcher.log` | 启动器日志，记录Windows AMMDS Launcher的启动过程、配置信息和系统集成状态 |

### 日志内容解读

#### AMMDS核心日志内容

**1. 系统运行日志 (`data/logs/ammds.log`)**

- 记录AMMDS的启动和停止事件
- 系统级错误和警告信息
- 配置加载和初始化状态
- 服务启动和停止状态

**2. 运行详细日志 (`data/logs/ammds-202x-xx-xx.log`)**

- 详细的操作记录和状态变化
- 用户操作和系统响应
- 资源使用情况和性能指标
- 定时任务执行情况

**3. 错误日志 (`data/logs/ammds-error.log`)**

- 详细的错误堆栈信息
- 异常发生的上下文
- 错误发生的时间和条件
- 可能的错误原因分析

#### Windows启动器日志内容

**启动器日志 (`logs/launcher.log`)**

- Launcher启动过程和配置加载
- 系统集成状态（托盘图标、自动启动）
- 与AMMDS核心的通信状态
- 启动器自身的错误和警告

#### 资源下载日志

**资源下载日志**（包含在相关日志文件中）：

- 资源文件名称和版本信息
- 下载进度和速度统计
- 下载状态（成功/失败/重试）
- 下载时间戳和耗时
- 下载服务器信息

:::info 进度指示
当日志中显示进度达到100%时，表示所有必要的资源文件已下载完成
:::

### 日志使用方法

#### 1. 故障排查

**AMMDS核心问题**

- 查看 `data/logs/ammds-error.log` 获取详细的错误信息
- 参考 `data/logs/ammds.log` 了解系统启动和初始化状态
- 分析 `data/logs/ammds-202x-xx-xx.log` 查看错误发生前后的操作记录

**启动器问题**

- 查看 `logs/launcher.log` 了解启动器启动过程和配置状态
- 检查与AMMDS核心的通信状态

#### 2. 资源管理

**资源下载问题**

- 分析日志中的下载记录，排查下载失败的资源
- 检查下载服务器连接状态
- 确认资源文件版本和完整性

**磁盘空间管理**

- 监控日志文件大小，定期清理过期日志
- 分析资源文件下载量，合理规划磁盘空间

#### 3. 性能分析

**系统性能**

- 分析日志中的时间戳，了解各操作的执行时间
- 监控资源使用情况，优化系统配置
- 识别性能瓶颈，调整系统参数

**启动时间优化**

- 分析 `logs/launcher.log` 中的启动过程耗时
- 检查 `data/logs/ammds.log` 中的初始化时间
- 优化启动项和配置，减少启动时间

#### 4. 日志文件管理

**日志轮转**

- AMMDS会自动进行日志轮转，生成日期命名的日志文件
- 过期日志会被压缩或清理，保持合理的磁盘占用

**日志备份**

- 定期备份重要的日志文件，特别是错误日志
- 在系统升级前备份当前日志，便于问题对比分析

**日志级别调整**

- 根据需要调整日志级别，平衡详细程度和性能影响
- 调试问题时使用详细日志，正常运行时使用标准日志

### 首次启动注意事项

:::warning 首次启动提示
首次启动AMMDS时，系统会执行以下操作，请耐心等待：

- **资源下载**：自动下载必要的资源文件，包括模型文件、依赖库等
- **时间预估**：根据网络速度不同，首次启动可能需要5-30分钟不等
- **网络要求**：请确保网络连接稳定，避免在下载过程中中断网络
- **磁盘空间**：需要足够的磁盘空间存储下载的资源文件，建议预留至少10GB空间
  :::

## 警告和注意事项

### 安全警告

:::danger 重要安全提示

- **官方来源**：仅从官方GitHub Releases页面下载AMMDS安装包，避免使用第三方下载源
- **杀毒软件**：安装过程中如遇杀毒软件提示，请确认是误报后添加信任
- **管理员权限**：安装和升级过程需要管理员权限，请确保以管理员身份运行安装程序
  :::

### 系统要求

:::info 系统配置要求

#### 最低配置

- 操作系统：Windows 10 64位
- 处理器：Intel Core i3或同等性能
- 内存：4GB RAM
- 磁盘空间：至少10GB可用空间
- 网络：宽带互联网连接

#### 推荐配置

- 操作系统：Windows 10/11 64位
- 处理器：Intel Core i5或同等性能
- 内存：8GB RAM或更多
- 磁盘空间：20GB可用空间
- 网络：稳定的宽带互联网连接

:::

### 使用注意事项

- **数据备份**：定期备份AMMDS的数据目录，特别是重要的配置文件和模型文件
- **资源管理**：监控磁盘空间使用情况，及时清理不需要的资源文件
- **网络连接**：确保稳定的网络连接，特别是在下载资源和更新时
- **系统维护**：定期更新Windows系统和相关驱动，确保系统稳定性

### 故障排除

#### 常见问题

- **安装失败**：检查管理员权限和磁盘空间
- **启动白屏**：等待资源下载完成，或检查网络连接
- **功能异常**：查看日志文件定位问题，或重启AMMDS Launcher
- **升级失败**：尝试先卸载旧版本再安装新版本

#### 联系方式

如遇到无法解决的问题，请访问官方GitHub仓库提交Issue或寻求帮助

### 最佳实践

- **定期更新**：保持AMMDS Launcher为最新版本，获取最新功能和安全修复
- **合理配置**：根据系统性能合理配置AMMDS参数，避免资源过度占用
- **安全使用**：遵循官方文档指导，避免修改核心配置文件
- **社区参与**：参与AMMDS社区，分享使用经验和反馈问题
