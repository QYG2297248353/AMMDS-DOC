---
outline: deep
---

# 任务配置

执行后台任务的一些默认配置

## 任务列表

展示已经创建的扫描任务，以及当前任务状态

### 创建扫描任务

建议针对不同目录，创建不同任务类型。

<a-image style="border-radius: 12px" src="/public/images/usage/task-config-001.png" />


<a-image style="border-radius: 12px" src="/public/images/usage/task-config-002.png" />


| 字段名称             | 描述                                       | 备注                           |
| -------------------- | ------------------------------------------ | ------------------------------ |
| 任务名称             | 简单描述任务概况                           | 必填项                         |
| 媒体类型             | 选择媒体的类型                             | 必填项                         |
| 整理模式             | 选择整理文件的方式                         | 必填项                         |
| 整理模式-选项        |                                            |                                |
| - 标准化整理(移动)   | 将文件移动到指定位置                       | 该选项需要设置目标目录         |
| - 标准化整理(复制)   | 将文件复制到指定位置                       | 该选项需要设置目标目录         |
| - 标准化整理(软连接) | 创建文件的软链接到指定位置                 | 该选项需要设置目标目录         |
| - 标准化整理(硬连接) | 创建文件的硬链接到指定位置                 | 该选项需要设置目标目录         |
| - 原地整理           | 在原位置进行整理                           |                                |
| 扫描目录             | 选择需要扫描的目录                         | 必填项                         |
| 整理目录             | 选择整理后的文件存放目录                   | 非原地整理必填                 |
| 重命名规则           | 选择文件重命名的规则                       | 必填项                         |
| 重复文件处理规则     | 选择如何处理重复文件                       | 必填项                         |
| 目录监控             | 开启或关闭目录监控                         | 监控开启后，不支持手动运行任务 |
| 加入收藏             | 开启后，扫描到的影视将在刮削后加入收藏列表 | 可选项                         |
| 计划任务             | 可填写 spring 风格 cron 表达式             | 可选项，用于设置定时任务       |

### 目录监控说明
- **开启**：实时目录监控，消耗资源较大，并且不支持手动运行任务。
- **关闭**：支持定时执行与手动执行。

### 计划任务说明
- 可填写 spring 风格 cron 表达式，用于设置定时任务。

```
    说明：
    Java(Spring)
    *    *    *    *    *    *
    -    -    -    -    -    -
    |    |    |    |    |    |
    |    |    |    |    |    +----- day of week (0 - 7) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
    |    |    |    |    +---------- month (1 - 12) OR jan,feb,mar,apr ...
    |    |    |    +--------------- day of month (1 - 31)
    |    |    +-------------------- hour (0 - 23)
    |    +------------------------- min (0 - 59)
    +------------------------------ second (0 - 59)
```

### 常见 Cron 表达式

| 表达式               | 说明                                     |
| -------------------- | ---------------------------------------- |
| `0 * * * * *`        | 每分钟的 0 秒执行一次                    |
| `0 0 * * * *`        | 每小时的 0 分 0 秒执行一次               |
| `0 0 12 * * *`       | 每天中午 12:00:00 执行一次               |
| `0 30 10 * * *`      | 每天上午 10:30:00 执行一次               |
| `0 0 0 * * *`        | 每天午夜 00:00:00 执行一次               |
| `0 0 8 * * mon`      | 每周一上午 8:00:00 执行一次              |
| `0 0 8 1 * *`        | 每月 1 号上午 8:00:00 执行一次           |
| `0 0 0 1 1 *`        | 每年 1 月 1 日 00:00:00 执行一次         |
| `0 0 12 */2 * *`     | 每隔 2 天的中午 12:00:00 执行一次        |
| `0 0 12 * jan,feb *` | 每年 1 月和 2 月的每天 12:00:00 执行一次 |
| `0 0 9-17 * * *`     | 每天 9:00 到 17:00 之间每小时执行一次    |
| `0 */15 * * * *`     | 每 15 分钟执行一次                       |
| `0 0 9-17/2 * * *`   | 每天 9:00-17:00 之间每 2 小时执行一次    |
| `0 0 22 * * 1-5`     | 每周一到周五晚上 22:00:00 执行一次       |

### 特殊字符说明

- `*`（星号）：匹配所有可能值
- `,`（逗号）：枚举多个值，例如 `mon,wed,fri` 表示星期一、三、五执行
- `-`（减号）：定义范围，例如 `9-17` 表示从 9 点到 17 点
- `/`（斜杠）：步进，例如 `*/15` 表示每 15 分钟执行一次
- `?`（问号）：仅用于“日期”和“星期”字段，表示忽略该字段
- `L`（最后）：用于“日期”和“星期”字段，例如 `L` 表示月末最后一天，`5L` 表示该月最后一个星期五
- `W`（工作日）：如 `15W` 表示本月 15 号的最近工作日
- `#`（指定第几个星期几）：如 `2#1` 表示当月第一个星期二


## 扫描规则配置

扫描时遵循的扫描规则


| 配置项       | 选项                                                                                                                | 描述                                     |
| ------------ | ------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- |
| 格式限制     | .mp4, .avi, .rmvb, .wmv, .mov, .mkv, .flv, .ts, .webm, .iso, .mpg                                                   | 允许处理的文件格式，已选择所有列出的格式 |
| 忽略目录     | behind the scenes, deleted scenes, interviews, scenes, samples, shorts, featurettes, clips, other, extras, trailers | 指定在扫描过程中需要忽略的目录类型       |
| 分段标记     | cd, dvd, part, pt, disc, disk                                                                                       | 指定文件名中包含的分段标记               |
| 字幕格式     | .srt, .sub, .ssa, .ass                                                                                              | 允许处理的字幕文件格式                   |
| 最小视频大小 | 100 MB                                                                                                              | 设置处理的视频文件的最小大小限制         |

### 配置说明

- **格式限制**：用户可以选择软件支持处理的视频和图像文件格式。
- **忽略目录**：用户可以指定在扫描过程中需要忽略的特定类型的目录，以避免不必要的文件被处理。
- **分段标记**：用户可以指定文件名中可能包含的分段标记，这些标记通常用于区分视频的不同部分。
- **字幕格式**：用户可以选择软件支持处理的字幕文件格式。
- **最小视频大小**：用户可以设置一个最小视频大小的阈值，只有大于或等于这个大小的视频文件才会被处理。


## 刮削规则配置

刮削并整理时遵循的扫描规则

| 配置项           | 当前值                                                                                                                    | 描述                                                                     |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| 字符过滤         | h_720, 2048论坛@fun2048.com, 1080p, 720p, 22-shtime, -HD, bbs2048.org, hhd800.com, icao.me, hhb_000, [456k.me], [Th2u.Cc] | 设置需要过滤的字符或字符串，防止这些字符出现在文件名中                   |
| 允许图片下载失败 | 关闭                                                                                                                      | 是否允许在图片下载失败时继续执行任务                                     |
| 整理目录格式     | `${actor}/${number}`                                                                                                      | 设置整理后的目录格式，使用变量 `${actor}` 表示演员，`${number}` 表示编号 |
| 整理文件名格式   | `${number}`                                                                                                               | 设置整理后的文件名格式，使用变量 `${number}` 表示编号                    |
| 自动刮削         | 关闭                                                                                                                      | 是否开启自动刮削功能，自动从数据库中获取并更新媒体信息                   |

### 配置说明

- **字符过滤**：用户可以指定一系列需要过滤的字符或字符串，这些字符将不会出现在处理后的文件名中。
- **允许图片下载失败**：用户可以选择是否允许在图片下载失败时继续执行任务。
- **整理目录格式**：用户可以设置整理后的目录格式，使用特定的变量来动态生成目录名。
- **整理文件名格式**：用户可以设置整理后的文件名格式，使用特定的变量来动态生成文件名。
- **自动刮削**：用户可以选择是否开启自动刮削功能，自动从数据库中获取并更新媒体信息。

::: danger 温馨提示
**自动刮削** 开启后，会定时进行媒体整理，针对追求数据完美的用户，不建议开启，建议完善媒体库数据后，在进行`刮削并整理`
:::

## 刮削代理配置

该配置影响全局外网的网络代理

| 配置项     | 当前值 | 描述                                |
| ---------- | ------ | ----------------------------------- |
| 开启代理   | 关闭   | 是否启用代理设置                    |
| 代理协议   | http   | 指定使用的代理协议类型 (http/socks) |
| 代理主机   |        | 输入代理服务器的主机名或IP地址      |
| 代理端口   | 0      | 输入代理服务器的端口号              |
| 代理用户名 |        | 输入代理服务器的用户名              |
| 代理密码   |        | 输入代理服务器的密码                |

### 配置说明

- **开启代理**：用户可以选择是否启用代理设置。当前设置为关闭状态。
- **代理协议**：用户需要指定使用的代理协议类型，如HTTP、HTTPS等。当前设置为HTTP。
- **代理主机**：用户需要输入代理服务器的主机名或IP地址。
- **代理端口**：用户需要输入代理服务器的端口号。默认端口号为0，通常需要更改为代理服务器的实际端口号。
- **代理用户名**：如果代理服务器需要身份验证，用户需要输入代理服务器的用户名。
- **代理密码**：如果代理服务器需要身份验证，用户需要输入代理服务器的密码。

