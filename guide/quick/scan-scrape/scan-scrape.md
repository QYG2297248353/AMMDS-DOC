---
outline: deep
---

# 扫描刮削

该功能需要的插件支持：<a-tag color="blue">MetaTube</a-tag>

## 配置扫描与刮削配置

修改任何配置请注意即时保存，避免配置丢失。

### 配置网络代理

`任务管理` >>>> `任务配置` >>>> `刮削代理配置`

+ 开启代理后全局生效
+ 代理协议仅支持：`http` `https` `socks4` `socks5`
+ 代理主机仅支持：`纯IP` `纯域名`
+ 代理端口：根据实际情况填写
+ 代理用户名：根据实际情况填写
+ 代理密码：根据实际情况填写

### 刮削规则配置

`任务管理` >>>> `任务配置` >>>> `刮削规则配置`

+ 允许图片下载失败：如果网络状况不好，可开启此项，跳过图片下载。
+ 整理目录格式：支持变量配置。
+ 整理文件名格式：支持变量配置。
+ 自动刮削：执行扫描后是需要手动执行刮削的，如果开启此项，将会自动进行刮削整理。

#### 整理规范变量

变量必须使用 `${}` 框起来，否则认为其为字符串，并作为名称的一部分。


| 变量名称   | 描述              |
| ---------- | ----------------- |
| actor      | 演员              |
| number     | 番号              |
| title      | 标题              |
| date       | 日期 yyyy/MM/dd   |
| year       | 年份 yyyy         |
| month      | 月份 MM           |
| day        | 日期 dd           |
| mosaic     | 马赛克            |
| resolution | 分辨率 1080p/720p |
| director   | 导演              |

默认整理目录规范：`${actor}/${number}`

默认整理文件规范：`${number}`

### 扫描规则配置

`任务管理` >>>> `任务配置` >>>> `扫描规则配置`

+ 格式限制：扫描时只针对符合的视频后缀格式进行扫描
+ 忽略目录：跳过扫描的目录(包括其子目录)
+ 分段标记：用于电影包含分段，上下部的情况进行细分处理
+ 字幕格式：识别的字幕格式
+ 最小视频大小：跳过小于该大小的视频文件

## 创建扫描任务

<a-image src="/images/quick/scan-scrape-001.png" />

| 名称                    | 描述                                                              |
| ----------------------- | ----------------------------------------------------------------- |
| 任务名称                | 用于任务分类                                                      |
| 媒体类型                | 辅助识别视频ID                                                    |
| 整理模式                | 整理规范                                                          |
| 整理模式-标准化整理     | 按照标准化整理文件 (其中涉及到创建软连接，硬链接，复制或移动文件) |
| 整理模式-原地整理       | 将标准信息整理到视频所在目录，仅做新增文件                        |
| 扫描目录                | 需要扫描的媒体目录                                                |
| 目标目录                | 标准化整理时的存储目录 (原地整理不填)                             |
| 重命名规则              | 视频文件重命名规则                                                |
| 重命名规则-标准化文件名 | 按照整理配置模板进行文件重命名                                    |
| 重命名规则-原文件名     | 不对视频文件做任何修改                                            |
| 重复文件处理规则        | 遇到重复文件时处理方式 (选择保留时，不对该视频文件做任何处理)     |
| 目录监控                | 扫描执行规则 (实时监控目录，即可进行扫描)，与计划任务二选一       |
| 加入收藏                | 扫描，刮削后加入收藏库列表 (可在前台进行检索，展示)               |
| 计划任务                | 标准的 cron 表达式，规范： Java(Spring) ，与目录监控二选一。      |




## 扫描结果

`任务管理` >>>> `扫描日志`

可以查看扫描运行记录，任务的基本信息。

## 执行刮削与整理

`任务管理` >>>> `刮削入库`

经过扫描识别到的媒体，会在该页面展示。

点击 `刮削整理`，会立即进行刮削整理，每次执行，最大支持 `30` 个任务。

这一步，必须配置插件：`MetaTube` 否则，请进行手动绑定，手动创建媒体信息。

## 刮削日志

可以查看刮削运行记录，刮削任务的基本信息。